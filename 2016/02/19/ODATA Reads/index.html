<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ODATA Reads | Tech Spot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Data READsLet’s start with a newer version of ODATA to access data from a existing service, In this solution I have used  Web API 2.2 with ODATA v4 
ODATA v4 packageVisual Studio has a built in packag">
<meta property="og:type" content="article">
<meta property="og:title" content="ODATA Reads">
<meta property="og:url" content="http://yoursite.com/2016/02/19/ODATA Reads/index.html">
<meta property="og:site_name" content="Tech Spot">
<meta property="og:description" content="Data READsLet’s start with a newer version of ODATA to access data from a existing service, In this solution I have used  Web API 2.2 with ODATA v4 
ODATA v4 packageVisual Studio has a built in packag">
<meta property="og:image" content="http://yoursite.com/images/nugetPackageManagementStore.png">
<meta property="og:image" content="http://yoursite.com/images/odataRelatedPackagesInstall.png">
<meta property="og:image" content="http://yoursite.com/images/registerServiceEndpoints.png">
<meta property="og:image" content="http://yoursite.com/images/studentController.png">
<meta property="og:image" content="http://yoursite.com/images/allAvailableEntities.png">
<meta property="og:image" content="http://yoursite.com/images/readStudents.png">
<meta property="og:image" content="http://yoursite.com/images/readDatatypes.png">
<meta property="og:image" content="http://yoursite.com/images/Excel2016odatav4.png">
<meta property="og:image" content="http://yoursite.com/images/dataConnectionWizard.png">
<meta property="og:image" content="http://yoursite.com/images/errorDataConnectionWizard.png">
<meta property="og:image" content="http://yoursite.com/images/errorExcel2013ODatav4.png">
<meta property="og:image" content="http://yoursite.com/images/Excel2016ODatav4WithPowerQuery.png">
<meta property="og:image" content="http://yoursite.com/images/powerQueryOdatafeed.png">
<meta property="og:image" content="http://yoursite.com/images/powerQueryEditor.png">
<meta property="og:image" content="http://yoursite.com/images/queryEditorWindow.png">
<meta property="og:updated_time" content="2016-09-18T16:18:12.318Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ODATA Reads">
<meta name="twitter:description" content="Data READsLet’s start with a newer version of ODATA to access data from a existing service, In this solution I have used  Web API 2.2 with ODATA v4 
ODATA v4 packageVisual Studio has a built in packag">
<meta name="twitter:image" content="http://yoursite.com/images/nugetPackageManagementStore.png">
  
    <link rel="alternate" href="/atom.xml" title="Tech Spot" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tech Spot</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-ODATA Reads" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/19/ODATA Reads/" class="article-date">
  <time datetime="2016-02-19T13:15:36.000Z" itemprop="datePublished">2016-02-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ODATA Reads
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Data-READs"><a href="#Data-READs" class="headerlink" title="Data READs"></a>Data READs</h2><p>Let’s start with a newer version of ODATA to access data from a existing service, In this solution I have used <em> Web API 2.2 with ODATA v4 </em></p>
<h2 id="ODATA-v4-package"><a href="#ODATA-v4-package" class="headerlink" title="ODATA v4 package"></a>ODATA v4 package</h2><p>Visual Studio has a built in package to create ODATA v4 services, Package contains all the libraries required to create a ODATA v4 endpoint.</p>
<h2 id="Integrate-ODATA-v4-package-into-solution"><a href="#Integrate-ODATA-v4-package-into-solution" class="headerlink" title="Integrate ODATA v4 package into solution"></a>Integrate ODATA v4 package into solution</h2><p>We can add the necessary OData package into solution like this, Select <em> Microsoft ASP.NET Web API 2.2 for OData v4.0 </em></p>
<p><img src="/images/nugetPackageManagementStore.png" alt="nuget package management store."></p>
<h2 id="All-the-relevant-libraries-are-installing"><a href="#All-the-relevant-libraries-are-installing" class="headerlink" title="All the relevant libraries are installing"></a>All the relevant libraries are installing</h2><p><img src="/images/odataRelatedPackagesInstall.png" alt="All the ODATA related libraries are installing."></p>
<h2 id="Register-OData-endpoint"><a href="#Register-OData-endpoint" class="headerlink" title="Register OData endpoint"></a>Register OData endpoint</h2><p>Register service endpoint in Register method of WebApiConfig file</p>
<p><img src="/images/registerServiceEndpoints.png" alt="Register service endpoints."></p>
<p>In line no 22, I have exposed the Student entity, Data read method is implemented in OData controller, <em> StudentController </em></p>
<h2 id="Student-Controller-implements-OData-Controller"><a href="#Student-Controller-implements-OData-Controller" class="headerlink" title="Student Controller implements OData Controller"></a>Student Controller implements OData Controller</h2><p><img src="/images/studentController.png" alt="Student Controller"></p>
<p><em>StudentController</em> inherits from OData Controller, So all the CRUD operations related to student can be implemented in this controller.</p>
<h2 id="How-it-works-in-the-browser"><a href="#How-it-works-in-the-browser" class="headerlink" title="How it works in the browser"></a>How it works in the browser</h2><p>now ping to the OData endpoint,</p>
<p><img src="/images/allAvailableEntities.png" alt="Available entities"></p>
<p>We can see all the available entities in the endpoint with metadata.</p>
<h2 id="Read-Students"><a href="#Read-Students" class="headerlink" title="Read Students"></a>Read Students</h2><p><img src="/images/readStudents.png" alt="Read Students"></p>
<p>By appending entity, <em> Student </em> into url, we can read student data</p>
<h2 id="Read-Data-types"><a href="#Read-Data-types" class="headerlink" title="Read Data types"></a>Read Data types</h2><p><img src="/images/readDatatypes.png" alt="Read data types"></p>
<p>We can read data types of student using the <em> $metadata </em> tag</p>
<h2 id="Excel-2016-with-OData-v4"><a href="#Excel-2016-with-OData-v4" class="headerlink" title="Excel 2016 with OData v4"></a>Excel 2016 with OData v4</h2><p>We already know office is not only for manipulating documents, We can perform many advanced queries with Excel. Excel supports to fetch data from different other sources, newer update is OData sources </p>
<p><img src="/images/Excel2016odatav4.png" alt="Excel 2016 - ODATA v4"></p>
<p>In excel 2016, We can connect to a OData source like this,</p>
<p><img src="/images/dataConnectionWizard.png" alt="Data connection wizard"></p>
<p>But we get an error!!!!!!</p>
<p><img src="/images/errorDataConnectionWizard.png" alt="error from Data connection wizard - office 2016 odata v4"></p>
<p>It clearly says Excel 2016 can be only integrated with Odata v3 or any earlier data feeds :) But for your information, with Excel 2016 as well as Excel 2013, we can integrate OData v3 </p>
<h2 id="Excel-2013-amp-OData-v4"><a href="#Excel-2013-amp-OData-v4" class="headerlink" title="Excel 2013 &amp; OData v4 ?"></a>Excel 2013 &amp; OData v4 ?</h2><p>With Excel 2013, ODATA v4 is not compatible. But we can use a V3 format service with Excel 2013.</p>
<p><img src="/images/errorExcel2013ODatav4.png" alt="error - office 2013 odata v4"></p>
<h2 id="Excel-2016-with-OData-v4-Power-Query"><a href="#Excel-2016-with-OData-v4-Power-Query" class="headerlink" title="Excel 2016 with OData v4 - Power Query"></a>Excel 2016 with OData v4 - Power Query</h2><p>With ODATA v4, we can’t use ODATA source option, But we have Power Query option to analyse data.</p>
<p><img src="/images/Excel2016ODatav4WithPowerQuery.png" alt="Excel 2016 - ODATA v4 with Power Query"></p>
<p>In Data tab, we have many options to fetch data from different other sources, We can select <em>From OData Feed</em> option.</p>
<p><img src="/images/powerQueryOdatafeed.png" alt="PowerQuery - Odata feed"></p>
<p>We can use Office 2016 Power Query option with OData v4.</p>
<h2 id="Power-Query-Editor"><a href="#Power-Query-Editor" class="headerlink" title="Power Query Editor"></a>Power Query Editor</h2><p><img src="/images/powerQueryEditor.png" alt="PowerQuery editor"></p>
<p>This is the query editor, we can select/remove columns, can remove duplicates, group by a column, create a new column based on a mathematical function and much more advanced operations.</p>
<p><img src="/images/queryEditorWindow.png" alt="Query editor window"></p>
<p>In the next section, we’ll see how to read data by passing a value :)</p>
<p>I could create a github repo for this code sample, Please feel free to check it, <a href="https://github.com/hansamaligamage/ODATAExample" target="_blank" rel="external">https://github.com/hansamaligamage/ODATAExample</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/02/19/ODATA Reads/" data-id="cits89tqk000aoogczewrai0u" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/03/02/ODATA Reads with Parameters/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ODATA Reads with Parameters
        
      </div>
    </a>
  
  
    <a href="/2016/01/23/ODATAFeatures/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ODATA Features</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/10/02/Create-a-Web-API-application-in-NETCore/">Create a Web API application in .NETCore</a>
          </li>
        
          <li>
            <a href="/2016/09/16/Create-a-web-application-with-Yeoman/">Create a web application with Yeoman!</a>
          </li>
        
          <li>
            <a href="/2016/09/15/Yeoman-go-easy-with-NETCore/">Install Yeoman in Ubuntu</a>
          </li>
        
          <li>
            <a href="/2016/09/15/Web-Application-in-NETCore-Ubuntu/">Listen to me in http://localhost:5000/ with .NETCore on Ubuntu</a>
          </li>
        
          <li>
            <a href="/2016/09/15/Hello-World-in-NETCore-Ubuntu/">Hello World in .NETCore Ubuntu</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Hansamali Gamage<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>