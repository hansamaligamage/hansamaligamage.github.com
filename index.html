<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Tech Spot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Tech Spot">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Tech Spot">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tech Spot">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="Tech Spot" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tech Spot</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-I-want-to-run-a-time-consuming-long-process-in-a-one-request" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/21/I-want-to-run-a-time-consuming-long-process-in-a-one-request/" class="article-date">
  <time datetime="2016-07-20T18:30:00.000Z" itemprop="datePublished">2016-07-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/21/I-want-to-run-a-time-consuming-long-process-in-a-one-request/">I want to run a time consuming long process in a one web request</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>In my application, I want to run a time consuming long process in a one web request. </p>
<p>At the begining, I used to call a web api method to run that process. But it didn’t work. Since the process takes long time to complete its action, request is getting hanged.</p>
<p>We can work on few options to resolve this,</p>
<ul>
<li>We can create a windows service to run this process, It’s a seperate process from the web request. We can periodically check whether action is completed or not until action gets completed, We can install this service in our local pc or server</li>
<li>Windows service installed in Azure worker role, If we want to host the windows service in cloud environment, we can host the service in azure worker role.</li>
<li>We can use a seperate thread to process the log runing action</li>
</ul>
<h2 id="Seperate-Background-worker-thread"><a href="#Seperate-Background-worker-thread" class="headerlink" title="Seperate Background worker thread"></a>Seperate Background worker thread</h2><p>In my solution, I used to create a background worker process to handle the long running task.</p>
<h2 id="How-my-code-looks-like"><a href="#How-my-code-looks-like" class="headerlink" title="How my code looks like"></a>How my code looks like</h2><p>If we have to use a seperate thread to run a time consuming action, We can use Web backgrounder third party package. It’s going to run a background process in specific intervals. When the task gets completed, it’s going to automatically kill the background process.<br>Let’s see the code in action!!!</p>
<h2 id="Install-Web-background-worker"><a href="#Install-Web-background-worker" class="headerlink" title="Install Web background worker"></a>Install Web background worker</h2><p>First of all, install the web background worker third party library into the project.</p>
<p><img src="/images/installBackgroundworker.PNG" alt="Background worker installation"></p>
<h2 id="Background-worker-implementation"><a href="#Background-worker-implementation" class="headerlink" title="Background worker implementation"></a>Background worker implementation</h2><p>This code snippet shows how to initialise a job and how to perform a action on it,</p>
<p><img src="/images/backgroundworker.PNG" alt="Background worker as in library"></p>
<p>I refered to the above code snippet and created a specific worker thread according to my requirements.<br>actual implementation of worker thread is shown below. Worker class should inherit from <em>IDisposable</em> interface.<br>In the constructor of the worker class, specify the time interval and then call long running action in a seperate thread.</p>
<p><img src="/images/actualWork.PNG" alt="Background worker"></p>
<p>Dispose() method is getting called when process is completed.</p>
<p><img src="/images/disposeMethod.PNG" alt="Dispose method"></p>
<h2 id="Web-api-controller-implementation"><a href="#Web-api-controller-implementation" class="headerlink" title="Web api controller implementation"></a>Web api controller implementation</h2><p><img src="/images/controller.PNG" alt="default methods"></p>
<p>I call this worker process inside a web api controller. Create a private static variable and initialise it with worker class constructor.</p>
<p><em>note : I added log messages to identify starting point and end point of the worker process, Here is a sample of that log.</em></p>
<p><img src="/images/log.PNG" alt="log file"></p>
<p>Until the task is getting completed, worker thread runs. It’s going to complete the process in second interval. When the task is completed, it’s going to dispose the worker thread.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/07/21/I-want-to-run-a-time-consuming-long-process-in-a-one-request/" data-id="ciqv70g1j0000ccgcm7ge09d9" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Easy-steps-to-create-a-windows-service" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/19/Easy-steps-to-create-a-windows-service/" class="article-date">
  <time datetime="2016-07-18T18:30:00.000Z" itemprop="datePublished">2016-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/19/Easy-steps-to-create-a-windows-service/">Schedule your tasks with a windows service</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>If you want to schedule something to run or your program takes long time to process, Sometimes we may have to create a seperate service application,<br>What i happened to write this post is, My client wanted me to write an application to send emails in specific time periods, So to achieve that I thought of writing a windows service application.<br>We can install this service in your server or local computer and configure it to run on intervals using a timer. Let’s start coding.</p>
<h2 id="Create-a-Windows-service"><a href="#Create-a-Windows-service" class="headerlink" title="Create a Windows service"></a>Create a Windows service</h2><p>When we create a windows service from visual studio, It gives us a service class with constructor method, OnStart and OnStop methods as follows.</p>
<p><img src="/images/defaultMethods.PNG" alt="default methods"></p>
<h2 id="Scheduling-the-task-with-a-timer"><a href="#Scheduling-the-task-with-a-timer" class="headerlink" title="Scheduling the task with a timer"></a>Scheduling the task with a timer</h2><p>I need to periodically perform a task, for that i need a timer component, We can add a timer into our service design from toolbox</p>
<p><img src="/images/timer.PNG" alt="Adding a timer"></p>
<h2 id="Fill-up-OnStart-method"><a href="#Fill-up-OnStart-method" class="headerlink" title="Fill up OnStart method"></a>Fill up OnStart method</h2><p>we need to initialise timer component inside the OnStart method, then I set timer interval and added a elapsed event to track each interval.</p>
<p><img src="/images/onStartMethod.PNG" alt="onStart method"></p>
<h2 id="Actual-scheduling-done-in-here"><a href="#Actual-scheduling-done-in-here" class="headerlink" title="Actual scheduling done in here"></a>Actual scheduling done in here</h2><p>inside timer elapsed event, actual task is going to run. elapsed event is called for each 2 minutes according to this code sample</p>
<p><img src="/images/timerElapsd.PNG" alt="timer Elapsed method"></p>
<h2 id="How-to-stop-the-execution"><a href="#How-to-stop-the-execution" class="headerlink" title="How to stop the execution"></a>How to stop the execution</h2><p>to stop the execution, OnStop event is used.</p>
<p><img src="/images/stopEvent.PNG" alt="stop event"></p>
<h2 id="How-to-install-the-windows-service"><a href="#How-to-install-the-windows-service" class="headerlink" title="How to install the windows service"></a>How to install the windows service</h2><p>Before installing the service in your pc, we need to create a installer class,</p>
<p><img src="/images/installer.PNG" alt="Installer class"></p>
<p>Add installer class as shown above</p>
<h2 id="Installer-Class"><a href="#Installer-Class" class="headerlink" title="Installer Class"></a>Installer Class</h2><p>in Installer class, we need to give a service name, so we can identify the service by its name. </p>
<p><img src="/images/installerCode.PNG" alt="Installer class code"></p>
<h2 id="Let’s-install-the-service"><a href="#Let’s-install-the-service" class="headerlink" title="Let’s install the service"></a>Let’s install the service</h2><p>service is getting created after we build the application. we can find the .exe file in the bin folder. But we can’t install the service by double clicking on it<br>we  have to install it to the local pc or server</p>
<h2 id="InstallUtil"><a href="#InstallUtil" class="headerlink" title="InstallUtil"></a>InstallUtil</h2><p>InstallUtil.exe is used to install/uninstall services in local machine or server. We can run installUtil command from Developer command prompt,<br>type InstallUtil.exe with full path to the service exe file.</p>
<p><img src="/images/Installutil.PNG" alt="Installutil"></p>
<p>But this doesn’t going to install the service, It throws an error.</p>
<p><img src="/images/errorInstallUtil.PNG" alt="Installutil permission issue"></p>
<p>It seems like we don’t have access to install the service, I had to spend few minutes to find the issue,<br>run Developer commad prompt as administrator, then this permission issue is getting resolved.</p>
<p>We can install a service using cmd as well,</p>
<p><img src="/images/cmd.PNG" alt="installutil in cmd"></p>
<p>run cmd as administrator, then we can install the service using cmd as well.</p>
<h2 id="View-services"><a href="#View-services" class="headerlink" title="View services"></a>View services</h2><p>We can check available services, by just typing services in your program list.</p>
<p><img src="/images/services.PNG" alt="logic of the service"></p>
<p>I gave service name as ‘test service’ in installer class.</p>
<h2 id="Windows-service-on-Local-Computer-started-and-then-stopped"><a href="#Windows-service-on-Local-Computer-started-and-then-stopped" class="headerlink" title="Windows service on Local Computer started and then stopped"></a>Windows service on Local Computer started and then stopped</h2><p>I tried to start the service from the panel, But it didnt work,<br>I came across with this issue as well, spent lot of hours to find the issue, this issue comes normally when code has some kind of a error. It’s somewhat difficult to debug a windows service application to find out errors, </p>
<h2 id="Debug-a-windows-service-application-easily"><a href="#Debug-a-windows-service-application-easily" class="headerlink" title="Debug a windows service application easily"></a>Debug a windows service application easily</h2><p>normally in a windows service, program.cs looks like this.</p>
<p><img src="/images/programcs.PNG" alt="program.cs file"></p>
<p>If we want to check whether our service implementation has any issue, we can use this trick</p>
<p><img src="/images/manualstart.PNG" alt="manually start the service"></p>
<p>manually start a method that has exact same code as the service implementation.<br>inside of start method implementation, we can check whether service logic works properly.</p>
<p><img src="/images/manualStartLogic.PNG" alt="logic of the service"></p>
<p>using this trick, we can identify our service logic is working fine.</p>
<p>Another way of testing the program logic is, create another console application and call service logic method from console app and verify it works fine.</p>
<h2 id="Debugger-Launch"><a href="#Debugger-Launch" class="headerlink" title="Debugger Launch"></a>Debugger Launch</h2><p>If we want to debug onStart method, we can launch the debugger in start method</p>
<p><img src="/images/debuggerLaunch.PNG" alt="launch the debugger"></p>
<p>we can launch the debugger like this,</p>
<p><img src="/images/launchDebugger.PNG" alt="launch the debugger"></p>
<p>we can debug the code like this.</p>
<p><img src="/images/debugMode.PNG" alt="launch the debugger"></p>
<p>But in here specific file we attatched into debugger is getting loaded. So other files are not loaded. Only we can debug the service file as this code sample shows.</p>
<h2 id="Windows-service-can’t-connect-to-the-database"><a href="#Windows-service-can’t-connect-to-the-database" class="headerlink" title="Windows service can’t connect to the database"></a>Windows service can’t connect to the database</h2><p>In my service, i need to access to the database, But it gives me an error like this.</p>
<p><strong> Login failed. Login failed for user ‘NT AUTHORITY\SYSTEM’ </strong></p>
<p>windows service is running on ‘NT AUTHORITY\SYSTEM’ login. this login doesn’t seem to have access to the database<br>To resolve this, add this in your connectionstring, Integrated Security=SSPI or else create a user account for ‘NT AUTHORITY\SYSTEM’ in your database server and give necessary permissions. </p>
<p>These are the guidelines to create a windows service, Enjoy the ride!</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/07/19/Easy-steps-to-create-a-windows-service/" data-id="ciqv70g1r0002ccgc1316tpsa" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Simple-smtp-email-with-html-body" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/30/Simple-smtp-email-with-html-body/" class="article-date">
  <time datetime="2016-06-29T18:30:00.000Z" itemprop="datePublished">2016-06-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/30/Simple-smtp-email-with-html-body/">Simple smtp email with html body</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Smtp-Email"><a href="#Smtp-Email" class="headerlink" title="Smtp Email"></a>Smtp Email</h2><p>This post describes an easy way to send a email using a smtp server.</p>
<h2 id="Smtp-Client"><a href="#Smtp-Client" class="headerlink" title="Smtp Client"></a>Smtp Client</h2><p>To create a smtp client, we need to specify a smtp host and port, port is an optional parameter.<br>for some Smtp clients, we need to provide credintials. we need a NetworkCredintial instance for that. We can use Secure Socket Layer (SSL) to encrypt the connection.</p>
<p><img src="/images/smtpClient.PNG" alt="SMTP Client"></p>
<p>This shows how to instantiate a smtp client, If you are using gmail, host is smtp.gmail.com or else some specific smtp server. If port is available, specify the port</p>
<h2 id="Mail-Message"><a href="#Mail-Message" class="headerlink" title="Mail Message"></a>Mail Message</h2><p>After working with Smtp client, then we need is MailMessage object.</p>
<p><img src="/images/mailMessage.PNG" alt="Mail Message"></p>
<p>MailMessage from and to should be MailAddress instances.<br>In this example we used <em>IsBodyHtml</em> attribute, to notify mail body can be a html string.</p>
<h2 id="Complete-code-is-shown-below"><a href="#Complete-code-is-shown-below" class="headerlink" title="Complete code is shown below"></a>Complete code is shown below</h2><p><img src="/images/completeCode.PNG" alt="Complete code to send an email"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/06/30/Simple-smtp-email-with-html-body/" data-id="ciqv70g240008ccgcirknp12c" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-NLog-Configurations" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/29/NLog-Configurations/" class="article-date">
  <time datetime="2016-05-28T18:30:00.000Z" itemprop="datePublished">2016-05-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/NLog-Configurations/">NLog Configurations</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Many of the systems, we develop today needs some kind of a logging/tracing mechanism to identify issues or any kind of information.</p>
<h2 id="NLog"><a href="#NLog" class="headerlink" title="NLog"></a>NLog</h2><p>NLog is a free logging framework to log various kind of messages into a specified place. We can use NLog in a .NET environment, as well as with Xamarin and Windows phone.</p>
<h2 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h2><p>If we want to log a message from our application, We can use EventViewer without any libraries. But If we want to share the log file with someone else and analyse it in the future, we can’t do that with Eventviewer.<br> So we have to go for a logging framework if we want to write messages into a file or a database.</p>
<h2 id="Logging-Frameworks"><a href="#Logging-Frameworks" class="headerlink" title="Logging Frameworks"></a>Logging Frameworks</h2><p> We can use any of these frameworks for logging purpose, <strong>Log4net</strong>, <strong>NLog</strong>, <strong>ELMAH</strong>, <strong>Microsoft Enterprise Library</strong>, <strong>NSpring</strong>. ELMAH is a web logging framework, All the other frameworks can be used with any .NET type of application.<br> When we use NLog or Log4net for logging, it takes just few minutes to integrate it to the application, But performancewise its not the same. NLog is much faster than Log4net and as well as all the above mentioned logging frameworks.<br> NSpring also easy to setup, but it requires more coding to log a message. With a large scale enterprise application, It will be tedious to work with NSpring.<br> Microsoft Enterprise Library (EntLib) is much faster, But need heavy configurations and coding to work with it. ELMAH is a web logger, It’s going to log the messages into a xml file by default.</p>
<p> If you application needs file logging and more performance, better to go with NLog or NSpring. We can use Log4net also, it’s not that much faster, but easy to setup and use it in the application</p>
<h2 id="Install-NLog"><a href="#Install-NLog" class="headerlink" title="Install NLog"></a>Install NLog</h2><p> Latest stable version of NLog is NLog 4.3.5.<br> With Nuget Package manager, I installed NLog,</p>
<p>  <img src="/images/NLogInstallation.PNG" alt="NLog installation"></p>
<h2 id="NLog-Targets"><a href="#NLog-Targets" class="headerlink" title="NLog Targets"></a>NLog Targets</h2><p> NLog targets are used to show, store or pass the message into another destination.  Some commonly used NLog targets are shown below,</p>
<ul>
<li>Console : writes message to a console window.</li>
<li>Event Log : writes message to event viewer.</li>
<li>Debugger : writes messagee to the attatched debugger.</li>
<li>File : writes log message to a file.</li>
<li>Database : store log message in database.</li>
<li>Memory : can write log message into a arraylist in memory.</li>
<li>Mail : send log message by email.</li>
<li>Method call : For log message, calls specific static method.</li>
<li>Network : send log message over a network.</li>
<li>Service : calls a web service for each log message. </li>
</ul>
<p>And if these targets dont satisfy your requirements, you can create your own targets as well, (custom target)</p>
<h2 id="Target-Layout"><a href="#Target-Layout" class="headerlink" title="Target Layout"></a>Target Layout</h2><p> Target layout means how our log message is going to display, in which format, which order. We can create custom layout renders as well. Commonly used layouts are as follows,</p>
<ul>
<li>${callsite} : Class name, method name or source information of the log message.</li>
<li>${callsite-linenumber} : line no of call site source.</li>
<li>${date} : date and time</li>
<li>${exception} : exception details</li>
<li>${level} : log level</li>
<li>${logger} : logger name</li>
<li>${longdate} : date and time in long format.</li>
<li>${message} : log message.</li>
<li>${stacktrace} : stack trace</li>
</ul>
<h2 id="NLog-rules"><a href="#NLog-rules" class="headerlink" title="NLog rules"></a>NLog rules</h2><p> NLog rules are called as a log routing table. It’s going to matches with a target and writes into a log with specified layout. Some of the attributes in NLog rules,</p>
<ul>
<li>name : logger name,</li>
<li>minlevel : minimum log level for a rule to match</li>
<li>maxlevel : maximum log level for a rule to match</li>
<li>level : single log level for a rule to match</li>
<li>levels : comma seperated list of logs for a rule to match</li>
<li>write to : comma seperated list of targets to be written when a rule matches</li>
<li>final : no further rules are processed when this rule matches</li>
<li>enabled : going to disable/enable rules</li>
</ul>
<h2 id="Nlog-levels"><a href="#Nlog-levels" class="headerlink" title="Nlog levels"></a>Nlog levels</h2><p> One thing to note, In these level attribute, log messages are ordered from type. Trace is the minlevel log type, then Debug, Info, Warn, Error and Fatal.</p>
<ul>
<li>Trace level can be used when we need to notify the begining and end of a method </li>
<li>Debug logs, we can identify whether session is expired, user is authenticated </li>
<li>Info logs are used for more generic scenarios like, Email sent.</li>
<li>Warn level can be used to notify warnings </li>
<li>Error logs are used for exceptions and when application crashes. </li>
<li>Fatal logs are highest level, used for most important cases.</li>
</ul>
<h2 id="Let’s-see-what’s-in-action"><a href="#Let’s-see-what’s-in-action" class="headerlink" title="Let’s see what’s in action"></a>Let’s see what’s in action</h2><p> In configuration file, I have configured log type and log level, I have used file logging, Trace as a minimum logging level.</p>
<p><img src="/images/configFile.PNG" alt="configuration file"></p>
<p> In code, I have written like this, </p>
<p><img src="/images/code.PNG" alt="code i have written"></p>
<p> Let’s check how it’s written in the log file</p>
<p><img src="/images/output.PNG" alt="output seeems like this"></p>
<p>In output, we can see the layout has been applied, ${longdate} ${callsite} ${callsite-linenumber} ${date} ${level} ${message}</p>
<h2 id="How-to-use-multiple-targets"><a href="#How-to-use-multiple-targets" class="headerlink" title="How to use multiple targets"></a>How to use multiple targets</h2><p>Let’s see how to add multiple targets for logging</p>
<p><img src="/images/MultipleTargetsConfig.PNG" alt="configuration file"></p>
<p>In configuration file, i added two targets, one is to log into a file, other target is to log into a console window</p>
<p><img src="/images/MultipleTargetsCode.PNG" alt="configuration file"></p>
<p> File logging output is same as previous output, console output is seems like this. In console logging, I used a different layout like this, ${date} ${callsite} ${level} ${message} and minimmum log level is added as Warning level, So output got changed like this.</p>
<p><strong> Some resources i referred, </strong></p>
<ul>
<li><a href="https://www.loggly.com/blog/benchmarking-5-popular-net-logging-libraries/" target="_blank" rel="external">https://www.loggly.com/blog/benchmarking-5-popular-net-logging-libraries/</a></li>
<li><a href="https://github.com/nlog/nlog/wiki/Layout-Renderers" target="_blank" rel="external">https://github.com/nlog/nlog/wiki/Layout-Renderers</a></li>
<li><a href="https://github.com/NLog/NLog/wiki/Log-levels" target="_blank" rel="external">https://github.com/NLog/NLog/wiki/Log-levels</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/29/NLog-Configurations/" data-id="ciqv70g1u0004ccgcmsjrkfoj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-LINQ comes to rescue" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/04/LINQ comes to rescue/" class="article-date">
  <time datetime="2016-04-03T18:30:00.000Z" itemprop="datePublished">2016-04-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/04/LINQ comes to rescue/">LINQ comes to rescue!</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Today, I’m going to explain a very small but tricky code part, day to day we use this, but never give it a second glance, because of that we miss this in many places :)</p>
<p>Let’s first create a simple class</p>
<p><img src="/images/carClass.png" alt="Car class"></p>
<p>we have list of cars, like this.</p>
<p><img src="/images/listOfCars.png" alt="List of cars"></p>
<p>I want to set <em>Milege</em> property as  ‘100’ when year is ‘2015’<br>so, what’s the method comes into your mind ?<br>for loop, foreach or while loop, Iterations are not so good when it comes to the performance.</p>
<p>With the help of LINQ, we can perform the filtering and modification both in just one line :)</p>
<p>In LINQ world, we have many operations to filter, to projection, to modify and many more.</p>
<p>Solution from LINQ,</p>
<p><img src="/images/linqQuery.png" alt="LINQ query to filter and modify list values."></p>
<p> Yes, It’s difficult to read the code though, But if you have performance concerns, and want to write the program with few lines of code, You can get use of this LINQ query.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/04/LINQ comes to rescue/" data-id="ciqv70g1t0003ccgcojdannw2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ODATA Reads with Parameters" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/02/ODATA Reads with Parameters/" class="article-date">
  <time datetime="2016-03-01T18:30:00.000Z" itemprop="datePublished">2016-03-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/02/ODATA Reads with Parameters/">ODATA Reads with Parameters</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Data-READs-with-Parameters"><a href="#Data-READs-with-Parameters" class="headerlink" title="Data READs with Parameters"></a>Data READs with Parameters</h2><p>In this post, We’ll focus on how to read a OData service with a parameter.</p>
<h2 id="Service-method-with-a-parameter"><a href="#Service-method-with-a-parameter" class="headerlink" title="Service method with a parameter"></a>Service method with a parameter</h2><p><img src="/images/GetMethodWithParameter.png" alt="Get Method With a Parameter."></p>
<p>Now, we’ll see how to retrieve data with a parameter,</p>
<h2 id="Url-in-the-browser"><a href="#Url-in-the-browser" class="headerlink" title="Url in the browser"></a>Url in the browser</h2><p><img src="/images/GetMethodUrl.png" alt="Get Method Url With a Parameter."></p>
<p>In browser, we can see only filtered students. in url, append the parameter with values.</p>
<h2 id="Power-Query-Window"><a href="#Power-Query-Window" class="headerlink" title="Power Query Window"></a>Power Query Window</h2><p><img src="/images/PowerQueryWindow.png" alt="Power Query editor."></p>
<p>From the Power Query window, we can see dataset like this.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/02/ODATA Reads with Parameters/" data-id="ciqv70g1w0005ccgcrh6uqcle" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ODATA Reads" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/19/ODATA Reads/" class="article-date">
  <time datetime="2016-02-19T13:15:36.000Z" itemprop="datePublished">2016-02-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/19/ODATA Reads/">ODATA Reads</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Data-READs"><a href="#Data-READs" class="headerlink" title="Data READs"></a>Data READs</h2><p>Let’s start with a newer version of ODATA to access data from a existing service, In this solution I have used <em> Web API 2.2 with ODATA v4 </em></p>
<h2 id="ODATA-v4-package"><a href="#ODATA-v4-package" class="headerlink" title="ODATA v4 package"></a>ODATA v4 package</h2><p>Visual Studio has a built in package to create ODATA v4 services, Package contains all the libraries required to create a ODATA v4 endpoint.</p>
<h2 id="Integrate-ODATA-v4-package-into-solution"><a href="#Integrate-ODATA-v4-package-into-solution" class="headerlink" title="Integrate ODATA v4 package into solution"></a>Integrate ODATA v4 package into solution</h2><p>We can add the necessary OData package into solution like this, Select <em> Microsoft ASP.NET Web API 2.2 for OData v4.0 </em></p>
<p><img src="/images/nugetPackageManagementStore.png" alt="nuget package management store."></p>
<h2 id="All-the-relevant-libraries-are-installing"><a href="#All-the-relevant-libraries-are-installing" class="headerlink" title="All the relevant libraries are installing"></a>All the relevant libraries are installing</h2><p><img src="/images/odataRelatedPackagesInstall.png" alt="All the ODATA related libraries are installing."></p>
<h2 id="Register-OData-endpoint"><a href="#Register-OData-endpoint" class="headerlink" title="Register OData endpoint"></a>Register OData endpoint</h2><p>Register service endpoint in Register method of WebApiConfig file</p>
<p><img src="/images/registerServiceEndpoints.png" alt="Register service endpoints."></p>
<p>In line no 22, I have exposed the Student entity, Data read method is implemented in OData controller, <em> StudentController </em></p>
<h2 id="Student-Controller-implements-OData-Controller"><a href="#Student-Controller-implements-OData-Controller" class="headerlink" title="Student Controller implements OData Controller"></a>Student Controller implements OData Controller</h2><p><img src="/images/studentController.png" alt="Student Controller"></p>
<p><em>StudentController</em> inherits from OData Controller, So all the CRUD operations related to student can be implemented in this controller.</p>
<h2 id="How-it-works-in-the-browser"><a href="#How-it-works-in-the-browser" class="headerlink" title="How it works in the browser"></a>How it works in the browser</h2><p>now ping to the OData endpoint,</p>
<p><img src="/images/allAvailableEntities.png" alt="Available entities"></p>
<p>We can see all the available entities in the endpoint with metadata.</p>
<h2 id="Read-Students"><a href="#Read-Students" class="headerlink" title="Read Students"></a>Read Students</h2><p><img src="/images/readStudents.png" alt="Read Students"></p>
<p>By appending entity, <em> Student </em> into url, we can read student data</p>
<h2 id="Read-Data-types"><a href="#Read-Data-types" class="headerlink" title="Read Data types"></a>Read Data types</h2><p><img src="/images/readDatatypes.png" alt="Read data types"></p>
<p>We can read data types of student using the <em> $metadata </em> tag</p>
<h2 id="Excel-2016-with-OData-v4"><a href="#Excel-2016-with-OData-v4" class="headerlink" title="Excel 2016 with OData v4"></a>Excel 2016 with OData v4</h2><p>We already know office is not only for manipulating documents, We can perform many advanced queries with Excel. Excel supports to fetch data from different other sources, newer update is OData sources </p>
<p><img src="/images/Excel2016odatav4.png" alt="Excel 2016 - ODATA v4"></p>
<p>In excel 2016, We can connect to a OData source like this,</p>
<p><img src="/images/dataConnectionWizard.png" alt="Data connection wizard"></p>
<p>But we get an error!!!!!!</p>
<p><img src="/images/errorDataConnectionWizard.png" alt="error from Data connection wizard - office 2016 odata v4"></p>
<p>It clearly says Excel 2016 can be only integrated with Odata v3 or any earlier data feeds :) But for your information, with Excel 2016 as well as Excel 2013, we can integrate OData v3 </p>
<h2 id="Excel-2013-amp-OData-v4"><a href="#Excel-2013-amp-OData-v4" class="headerlink" title="Excel 2013 &amp; OData v4 ?"></a>Excel 2013 &amp; OData v4 ?</h2><p>With Excel 2013, ODATA v4 is not compatible. But we can use a V3 format service with Excel 2013.</p>
<p><img src="/images/errorExcel2013ODatav4.png" alt="error - office 2013 odata v4"></p>
<h2 id="Excel-2016-with-OData-v4-Power-Query"><a href="#Excel-2016-with-OData-v4-Power-Query" class="headerlink" title="Excel 2016 with OData v4 - Power Query"></a>Excel 2016 with OData v4 - Power Query</h2><p>With ODATA v4, we can’t use ODATA source option, But we have Power Query option to analyse data.</p>
<p><img src="/images/Excel2016ODatav4WithPowerQuery.png" alt="Excel 2016 - ODATA v4 with Power Query"></p>
<p>In Data tab, we have many options to fetch data from different other sources, We can select <em>From OData Feed</em> option.</p>
<p><img src="/images/powerQueryOdatafeed.png" alt="PowerQuery - Odata feed"></p>
<p>We can use Office 2016 Power Query option with OData v4.</p>
<h2 id="Power-Query-Editor"><a href="#Power-Query-Editor" class="headerlink" title="Power Query Editor"></a>Power Query Editor</h2><p><img src="/images/powerQueryEditor.png" alt="PowerQuery editor"></p>
<p>This is the query editor, we can select/remove columns, can remove duplicates, group by a column, create a new column based on a mathematical function and much more advanced operations.</p>
<p><img src="/images/queryEditorWindow.png" alt="Query editor window"></p>
<p>In the next section, we’ll see how to read data by passing a value :)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/02/19/ODATA Reads/" data-id="ciqv70g1y0006ccgcz0lhgvdu" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ODATAFeatures" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/23/ODATAFeatures/" class="article-date">
  <time datetime="2016-01-23T13:15:36.000Z" itemprop="datePublished">2016-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/23/ODATAFeatures/">ODATA Features</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ODATA"><a href="#ODATA" class="headerlink" title="ODATA"></a>ODATA</h2><p>ODATA is a open data protocol to access data using REST architecture. ODATA is a Microsoft standard, but available with Android &amp; IOS platforms as well. ODATA supports for JSON and Atom formats. With the help of ODATA , we can access data in variety of sources like relational databases, Web sites, File systems and Content Management Systems.</p>
<h2 id="ODATA-has-more-features-than-REST"><a href="#ODATA-has-more-features-than-REST" class="headerlink" title="ODATA has more features than REST!"></a>ODATA has more features than REST!</h2><p>REST is an architectural pattern to implement a service, But with ODATA it’s going to provide more features to more sources like File systems, Content Management Systems. ODATA services supports for query options like filter, select, expand, order by and many more. As per our requirement, we can filter the result set, order as we want. And we can skip some rows, Even we can select the top row as well.</p>
<h2 id="It’s-2016"><a href="#It’s-2016" class="headerlink" title="It’s 2016!!!!"></a>It’s 2016!!!!</h2><p>Microsoft has introduced variety of features with Office 2016, If your old REST services are using ODATA protocol, We can implement a simple power BI solution just with Excel itself.</p>
<h2 id="ODATA-Versions-so-far"><a href="#ODATA-Versions-so-far" class="headerlink" title="ODATA Versions so far"></a>ODATA Versions so far</h2><p>After ODATA V2 and ODATA V3, Now ODATA V4 has been released as a major release. If you want to build a open data service, we can use <strong> ODATA v4 with WebAPI 2.2 </strong> as a solution.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/23/ODATAFeatures/" data-id="ciqv70g220007ccgc6gi3o0wi" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/07/21/I-want-to-run-a-time-consuming-long-process-in-a-one-request/">I want to run a time consuming long process in a one web request</a>
          </li>
        
          <li>
            <a href="/2016/07/19/Easy-steps-to-create-a-windows-service/">Schedule your tasks with a windows service</a>
          </li>
        
          <li>
            <a href="/2016/06/30/Simple-smtp-email-with-html-body/">Simple smtp email with html body</a>
          </li>
        
          <li>
            <a href="/2016/05/29/NLog-Configurations/">NLog Configurations</a>
          </li>
        
          <li>
            <a href="/2016/04/04/LINQ comes to rescue/">LINQ comes to rescue!</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Hansamali Gamage<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>