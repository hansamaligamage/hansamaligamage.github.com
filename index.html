<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Tech Spot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Tech Spot">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Tech Spot">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tech Spot">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="Tech Spot" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tech Spot</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-NLog-Configurations" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/29/NLog-Configurations/" class="article-date">
  <time datetime="2016-06-28T18:30:00.000Z" itemprop="datePublished">2016-06-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/29/NLog-Configurations/">NLog Configurations</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Many of the systems, we develop today needs some kind of a logging/tracing mechanism to identify issues or any kind of information.</p>
<h2 id="NLog"><a href="#NLog" class="headerlink" title="NLog"></a>NLog</h2><p>NLog is a free logging framework to log various kind of messages into a specified place. We can use NLog in a .NET environment, as well as with Xamarin and Windows phone.</p>
<h2 id="Logging"><a href="#Logging" class="headerlink" title="Logging"></a>Logging</h2><p>If we want to log a message from our application, We can use EventViewer without any libraries. But If we want to share the log file with someone else and analyse it in the future, we can’t do that with Eventviewer.<br> So we have to go for a logging framework if we want to write messages into a file or a database.</p>
<h2 id="Logging-Frameworks"><a href="#Logging-Frameworks" class="headerlink" title="Logging Frameworks"></a>Logging Frameworks</h2><p> We can use any of these framework for logging purpose, Log4net, NLog, ELMAH, Microsoft Enterprise Library, NSpring, ELMAH is a web logging framework, All the other frameworks can be used with any .NET type of application.<br> When we use NLog or Log4net for logging, it takes just few minutes to integrate it to the application, But performancewise its not the same. NLog is much faster than Log4net and as well as all the above mentioned logging frameworks.<br> NSpring also easy to setup, but it requires more coding to log a message. With a large scale enterprise application, It will be tedious to work with NSpring.<br> Microsoft Enterprise Library (EntLib) is much faster, But need heavy configurations and coding to work with it. ELMAH is a web logger, It’s going to log the messages into a xml file by default.</p>
<p> If you application needs file logging and more performance, better to go with NLog or NSpring. We can use Log4net also, it’s not that much faster, but easy to setup and use it in the application</p>
<h2 id="Install-NLog"><a href="#Install-NLog" class="headerlink" title="Install NLog"></a>Install NLog</h2><p> Latest stable version of NLog up to now is NLog 4.3.5. With Nuget Package manager, I installed NLog,</p>
<p><img src="/images/carClass.png" alt="NLog Installation in Package Manager"></p>
<h2 id="NLog-Targets"><a href="#NLog-Targets" class="headerlink" title="NLog Targets"></a>NLog Targets</h2><p> NLog targets are used to show, store or pass the message into another destination.<br> Some commonly used NLog targets are shown below.<br> Console : writes message to a console window.<br> Event Log : writes message to event viewer.<br> Debugger : writes messagee to the attatched debugger.<br> File : writes log message to a file.<br> Database : store log message in database.<br> Memory : can write log message into a arraylist in memory.<br> Mail : send log message by email.<br> Method call : For log message, calls specific static method.<br> Network : send log message over a network.<br> Service : calls a web service for each log message.<br>And if these targets dont satisfy your requirements, you can create your own target, (custom target)</p>
<h2 id="Target-Layout"><a href="#Target-Layout" class="headerlink" title="Target Layout"></a>Target Layout</h2><p> Target layout means how our log message is going to display, in which format, which order. We can create custom layout renders as well.<br> Commonly used layouts are as follows,<br> ${callsite} : Class name, method name or source information of the log message.<br> ${callsite-linenumber} : line no of call site source.<br> ${date} : date and time<br> ${exception} : exception details<br> ${level} : log level<br> ${logger} : logger name<br> ${longdate} : date and time in long format.<br> ${message} : log message.<br> ${stacktrace} : stack trace</p>
<h2 id="NLog-rules"><a href="#NLog-rules" class="headerlink" title="NLog rules"></a>NLog rules</h2><p> NLog rules are called as a log routing table. It’s going to matches with a target and writes into a log with specified layout.<br> Some of the attributes in NLog rules,<br> name : logger name,<br> minlevel : minimum log level for a rule to match<br> maxlevel : maximum log level for a rule to match<br> level : single log level for a rule to match<br> levels : comma seperated list of logs for a rule to match<br> write to : comma seperated list of targets to be written when a rule matches<br> final : no further rules are processed when this rule matches<br> enabled : going to disable/enable rules</p>
<h2 id="Nlog-levels"><a href="#Nlog-levels" class="headerlink" title="Nlog levels"></a>Nlog levels</h2><p> One thing to note, In these level attribute, log messages are ordered from type. Trace is the minlevel log type, then Debug, Info, Warn, Error and Fatal.<br> Trace level can be used when we need to notify the begining and end of a method, From Debug logs, we can identify whether session is expired, user is authenticated. Info logs are used for more generic scenarios like, Email sent.<br> Warn level can be used to notify warnings, Error logs are used for exceptions and when application crashes. Fatal logs are highest level, for most important cases.</p>
<h2 id="Let’s-see-what’s-in-action"><a href="#Let’s-see-what’s-in-action" class="headerlink" title="Let’s see what’s in action"></a>Let’s see what’s in action</h2><p> In configuration file, I have configured log type and log level, I have used file logging, Trace as a minimum logging level.</p>
<p> picccc</p>
<p> In code, I have written like this, </p>
<p> piccccccc</p>
<p> Let’s check how it’s written in the log file</p>
<p> piccccccccc</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/06/29/NLog-Configurations/" data-id="ciq2m70j50002u0gcyqnqa2ul" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-LINQ comes to rescue" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/04/LINQ comes to rescue/" class="article-date">
  <time datetime="2016-04-03T18:30:00.000Z" itemprop="datePublished">2016-04-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/04/LINQ comes to rescue/">LINQ comes to rescue!</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Today, I’m going to explain a very small but tricky code part, day to day we use this, but never give it a second glance, because of that we miss this in many places :)</p>
<p>Let’s first create a simple class</p>
<p><img src="/images/carClass.png" alt="Car class"></p>
<p>we have list of cars, like this.</p>
<p><img src="/images/listOfCars.png" alt="List of cars"></p>
<p>I want to set <em>Milege</em> property as  ‘100’ when year is ‘2015’<br>so, what’s the method comes into your mind ?<br>for loop, foreach or while loop, Iterations are not so good when it comes to the performance.</p>
<p>With the help of LINQ, we can perform the filtering and modification both in just one line :)</p>
<p>In LINQ world, we have many operations to filter, to projection, to modify and many more.</p>
<p>Solution from LINQ,</p>
<p><img src="/images/linqQuery.png" alt="LINQ query to filter and modify list values."></p>
<p> Yes, It’s difficult to read the code though, But if you have performance concerns, and want to write the program with few lines of code, You can get use of this LINQ query.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/04/LINQ comes to rescue/" data-id="ciq2m70j50001u0gcmyagfthu" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ODATA Reads with Parameters" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/02/ODATA Reads with Parameters/" class="article-date">
  <time datetime="2016-03-01T18:30:00.000Z" itemprop="datePublished">2016-03-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/02/ODATA Reads with Parameters/">ODATA Reads with Parameters</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Data-READs-with-Parameters"><a href="#Data-READs-with-Parameters" class="headerlink" title="Data READs with Parameters"></a>Data READs with Parameters</h2><p>In this post, We’ll focus on how to read a OData service with a parameter.</p>
<h2 id="Service-method-with-a-parameter"><a href="#Service-method-with-a-parameter" class="headerlink" title="Service method with a parameter"></a>Service method with a parameter</h2><p><img src="/images/GetMethodWithParameter.png" alt="Get Method With a Parameter."></p>
<p>Now, we’ll see how to retrieve data with a parameter,</p>
<h2 id="Url-in-the-browser"><a href="#Url-in-the-browser" class="headerlink" title="Url in the browser"></a>Url in the browser</h2><p><img src="/images/GetMethodUrl.png" alt="Get Method Url With a Parameter."></p>
<p>In browser, we can see only filtered students. in url, append the parameter with values.</p>
<h2 id="Power-Query-Window"><a href="#Power-Query-Window" class="headerlink" title="Power Query Window"></a>Power Query Window</h2><p><img src="/images/PowerQueryWindow.png" alt="Power Query editor."></p>
<p>From the Power Query window, we can see dataset like this.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/02/ODATA Reads with Parameters/" data-id="ciq2m70ip0000u0gc45n7z75i" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ODATA Reads" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/19/ODATA Reads/" class="article-date">
  <time datetime="2016-02-19T13:15:36.000Z" itemprop="datePublished">2016-02-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/19/ODATA Reads/">ODATA Reads</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Data-READs"><a href="#Data-READs" class="headerlink" title="Data READs"></a>Data READs</h2><p>Let’s start with a newer version of ODATA to access data from a existing service, In this solution I have used <em> Web API 2.2 with ODATA v4 </em></p>
<h2 id="ODATA-v4-package"><a href="#ODATA-v4-package" class="headerlink" title="ODATA v4 package"></a>ODATA v4 package</h2><p>Visual Studio has a built in package to create ODATA v4 services, Package contains all the libraries required to create a ODATA v4 endpoint.</p>
<h2 id="Integrate-ODATA-v4-package-into-solution"><a href="#Integrate-ODATA-v4-package-into-solution" class="headerlink" title="Integrate ODATA v4 package into solution"></a>Integrate ODATA v4 package into solution</h2><p>We can add the necessary OData package into solution like this, Select <em> Microsoft ASP.NET Web API 2.2 for OData v4.0 </em></p>
<p><img src="/images/nugetPackageManagementStore.png" alt="nuget package management store."></p>
<h2 id="All-the-relevant-libraries-are-installing"><a href="#All-the-relevant-libraries-are-installing" class="headerlink" title="All the relevant libraries are installing"></a>All the relevant libraries are installing</h2><p><img src="/images/odataRelatedPackagesInstall.png" alt="All the ODATA related libraries are installing."></p>
<h2 id="Register-OData-endpoint"><a href="#Register-OData-endpoint" class="headerlink" title="Register OData endpoint"></a>Register OData endpoint</h2><p>Register service endpoint in Register method of WebApiConfig file</p>
<p><img src="/images/registerServiceEndpoints.png" alt="Register service endpoints."></p>
<p>In line no 22, I have exposed the Student entity, Data read method is implemented in OData controller, <em> StudentController </em></p>
<h2 id="Student-Controller-implements-OData-Controller"><a href="#Student-Controller-implements-OData-Controller" class="headerlink" title="Student Controller implements OData Controller"></a>Student Controller implements OData Controller</h2><p><img src="/images/studentController.png" alt="Student Controller"></p>
<p><em>StudentController</em> inherits from OData Controller, So all the CRUD operations related to student can be implemented in this controller.</p>
<h2 id="How-it-works-in-the-browser"><a href="#How-it-works-in-the-browser" class="headerlink" title="How it works in the browser"></a>How it works in the browser</h2><p>now ping to the OData endpoint,</p>
<p><img src="/images/allAvailableEntities.png" alt="Available entities"></p>
<p>We can see all the available entities in the endpoint with metadata.</p>
<h2 id="Read-Students"><a href="#Read-Students" class="headerlink" title="Read Students"></a>Read Students</h2><p><img src="/images/readStudents.png" alt="Read Students"></p>
<p>By appending entity, <em> Student </em> into url, we can read student data</p>
<h2 id="Read-Data-types"><a href="#Read-Data-types" class="headerlink" title="Read Data types"></a>Read Data types</h2><p><img src="/images/readDatatypes.png" alt="Read data types"></p>
<p>We can read data types of student using the <em> $metadata </em> tag</p>
<h2 id="Excel-2016-with-OData-v4"><a href="#Excel-2016-with-OData-v4" class="headerlink" title="Excel 2016 with OData v4"></a>Excel 2016 with OData v4</h2><p>We already know office is not only for manipulating documents, We can perform many advanced queries with Excel. Excel supports to fetch data from different other sources, newer update is OData sources </p>
<p><img src="/images/Excel2016odatav4.png" alt="Excel 2016 - ODATA v4"></p>
<p>In excel 2016, We can connect to a OData source like this,</p>
<p><img src="/images/dataConnectionWizard.png" alt="Data connection wizard"></p>
<p>But we get an error!!!!!!</p>
<p><img src="/images/errorDataConnectionWizard.png" alt="error from Data connection wizard - office 2016 odata v4"></p>
<p>It clearly says Excel 2016 can be only integrated with Odata v3 or any earlier data feeds :) But for your information, with Excel 2016 as well as Excel 2013, we can integrate OData v3 </p>
<h2 id="Excel-2013-amp-OData-v4"><a href="#Excel-2013-amp-OData-v4" class="headerlink" title="Excel 2013 &amp; OData v4 ?"></a>Excel 2013 &amp; OData v4 ?</h2><p>With Excel 2013, ODATA v4 is not compatible. But we can use a V3 format service with Excel 2013.</p>
<p><img src="/images/errorExcel2013ODatav4.png" alt="error - office 2013 odata v4"></p>
<h2 id="Excel-2016-with-OData-v4-Power-Query"><a href="#Excel-2016-with-OData-v4-Power-Query" class="headerlink" title="Excel 2016 with OData v4 - Power Query"></a>Excel 2016 with OData v4 - Power Query</h2><p>With ODATA v4, we can’t use ODATA source option, But we have Power Query option to analyse data.</p>
<p><img src="/images/Excel2016ODatav4WithPowerQuery.png" alt="Excel 2016 - ODATA v4 with Power Query"></p>
<p>In Data tab, we have many options to fetch data from different other sources, We can select <em>From OData Feed</em> option.</p>
<p><img src="/images/powerQueryOdatafeed.png" alt="PowerQuery - Odata feed"></p>
<p>We can use Office 2016 Power Query option with OData v4.</p>
<h2 id="Power-Query-Editor"><a href="#Power-Query-Editor" class="headerlink" title="Power Query Editor"></a>Power Query Editor</h2><p><img src="/images/powerQueryEditor.png" alt="PowerQuery editor"></p>
<p>This is the query editor, we can select/remove columns, can remove duplicates, group by a column, create a new column based on a mathematical function and much more advanced operations.</p>
<p><img src="/images/queryEditorWindow.png" alt="Query editor window"></p>
<p>In the next section, we’ll see how to read data by passing a value :)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/02/19/ODATA Reads/" data-id="ciq2m70j50003u0gc3cujb6o0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ODATAFeatures" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/23/ODATAFeatures/" class="article-date">
  <time datetime="2016-01-23T13:15:36.000Z" itemprop="datePublished">2016-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/23/ODATAFeatures/">ODATA Features</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ODATA"><a href="#ODATA" class="headerlink" title="ODATA"></a>ODATA</h2><p>ODATA is a open data protocol to access data using REST architecture. ODATA is a Microsoft standard, but available with Android &amp; IOS platforms as well. ODATA supports for JSON and Atom formats. With the help of ODATA , we can access data in variety of sources like relational databases, Web sites, File systems and Content Management Systems.</p>
<h2 id="ODATA-has-more-features-than-REST"><a href="#ODATA-has-more-features-than-REST" class="headerlink" title="ODATA has more features than REST!"></a>ODATA has more features than REST!</h2><p>REST is an architectural pattern to implement a service, But with ODATA it’s going to provide more features to more sources like File systems, Content Management Systems. ODATA services supports for query options like filter, select, expand, order by and many more. As per our requirement, we can filter the result set, order as we want. And we can skip some rows, Even we can select the top row as well.</p>
<h2 id="It’s-2016"><a href="#It’s-2016" class="headerlink" title="It’s 2016!!!!"></a>It’s 2016!!!!</h2><p>Microsoft has introduced variety of features with Office 2016, If your old REST services are using ODATA protocol, We can implement a simple power BI solution just with Excel itself.</p>
<h2 id="ODATA-Versions-so-far"><a href="#ODATA-Versions-so-far" class="headerlink" title="ODATA Versions so far"></a>ODATA Versions so far</h2><p>After ODATA V2 and ODATA V3, Now ODATA V4 has been released as a major release. If you want to build a open data service, we can use <strong> ODATA v4 with WebAPI 2.2 </strong> as a solution.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/23/ODATAFeatures/" data-id="ciq2m70j50004u0gcxqbfkxim" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/06/29/NLog-Configurations/">NLog Configurations</a>
          </li>
        
          <li>
            <a href="/2016/04/04/LINQ comes to rescue/">LINQ comes to rescue!</a>
          </li>
        
          <li>
            <a href="/2016/03/02/ODATA Reads with Parameters/">ODATA Reads with Parameters</a>
          </li>
        
          <li>
            <a href="/2016/02/19/ODATA Reads/">ODATA Reads</a>
          </li>
        
          <li>
            <a href="/2016/01/23/ODATAFeatures/">ODATA Features</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Hansamali Gamage<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>